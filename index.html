<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Smartphone Banana - AI画像生成アプリ">
    <meta name="theme-color" content="#FFD700">
    <title>Smartphone Banana</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icons/icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icons/icon-512.png">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <img src="icons/icon-192.png" alt="Smartphone Banana" class="header-icon">
                <div class="header-text">
                    <h1>Smartphone Banana <span class="version">v0.1.25</span></h1>
                </div>
            </div>
        </header>

        <main>
            <div class="input-section">
                <div class="api-key-accordion">
                    <button type="button" class="accordion-toggle" id="apiKeyToggle">
                        <span>⚙️ API設定</span>
                        <span class="accordion-icon">▼</span>
                    </button>
                    <div class="accordion-content" id="apiKeyContent">
                        <div class="api-key-section">
                            <label for="api_key">FAL API Key:</label>
                            <input
                                type="password"
                                id="api_key"
                                placeholder="APIキーを入力..."
                                autocomplete="off"
                            >
                            <div class="api-key-buttons">
                                <button type="button" id="saveApiKeyBtn" class="api-btn save-btn">保存</button>
                                <button type="button" id="deleteApiKeyBtn" class="api-btn delete-btn">削除</button>
                            </div>
                            <small>
                                APIキーは<a href="https://fal.ai/dashboard/keys" target="_blank" rel="noopener noreferrer">こちら</a>から取得できます。<br>
                                APIキーはブラウザのローカルストレージに保存されます（暗号化されません）。他人と共有する端末では使用しないでください。
                            </small>
                        </div>
                    </div>
                </div>

                <hr class="section-divider">

                <label for="prompt">プロンプトを入力してください:</label>
                <textarea
                    id="prompt"
                    rows="4"
                    placeholder="例: An action shot of a black lab swimming in an inground suburban swimming pool..."
                ></textarea>

                <div class="custom-prompts-section">
                    <div class="custom-prompts-accordion">
                        <button type="button" class="accordion-toggle" id="customPromptsToggle">
                            <span>📝 カスタムプロンプト設定</span>
                            <span class="accordion-icon">▼</span>
                        </button>
                        <div class="accordion-content" id="customPromptsContent">
                            <div class="custom-prompts-list" id="customPromptsList"></div>
                        </div>
                    </div>
                    <div class="custom-prompts-buttons" id="customPromptsButtons"></div>
                </div>

                <hr class="section-divider">

                <div class="image-upload-section">
                    <label>参照画像 (最大4枚、オプション):</label>
                    <input type="file" id="imageFileInput" accept="image/*" multiple style="display: none;">
                    <input type="file" id="cameraFileInput" accept="image/*" capture="environment" style="display: none;">
                    <div class="upload-controls" id="uploadControls">
                        <div class="upload-drop-zone" id="uploadDropZone">
                            <p>📷 クリックまたはドラッグ&ドロップで画像を追加</p>
                            <small>最大4枚まで選択可能</small>
                        </div>
                        <div class="camera-zone" id="cameraZone">
                            <button type="button" class="camera-btn" id="cameraBtn" title="カメラで撮影">
                                <img src="icons/camera.png" alt="カメラ" class="camera-icon">
                            </button>
                        </div>
                    </div>
                    <div class="image-preview-container" id="imagePreviewContainer"></div>
                </div>

                <div class="image-library-accordion">
                    <button type="button" class="accordion-toggle" id="imageLibraryToggle">
                        <span>🖼️ 画像ライブラリ</span>
                        <span class="accordion-icon">▼</span>
                    </button>
                    <div class="accordion-content" id="imageLibraryContent">
                        <div class="image-library-section">
                            <input type="file" id="libraryFileInput" accept="image/*" multiple style="display: none;">
                            <button type="button" class="library-add-btn" id="libraryAddBtn">ライブラリに画像を追加（クリックまたはドラッグ&ドロップ）</button>
                            <div class="image-library-grid" id="imageLibraryGrid"></div>
                        </div>
                    </div>
                </div>

                <hr class="section-divider">

                <div class="settings">
                    <div class="setting-item">
                        <label for="num_images">画像数:</label>
                        <select id="num_images">
                            <option value="1" selected>1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label for="aspect_ratio">アスペクト比:</label>
                        <select id="aspect_ratio">
                            <option value="1:1" selected>1:1 (正方形)</option>
                            <option value="16:9">16:9 (横長)</option>
                            <option value="9:16">9:16 (縦長)</option>
                            <option value="4:3">4:3</option>
                            <option value="3:4">3:4</option>
                            <option value="21:9">21:9</option>
                            <option value="3:2">3:2</option>
                            <option value="2:3">2:3</option>
                            <option value="5:4">5:4</option>
                            <option value="4:5">4:5</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label for="resolution">解像度:</label>
                        <select id="resolution">
                            <option value="1K" selected>1K</option>
                            <option value="2K">2K</option>
                            <option value="4K">4K</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label for="output_format">フォーマット:</label>
                        <select id="output_format">
                            <option value="png" selected>PNG</option>
                            <option value="jpeg">JPEG</option>
                            <option value="webp">WebP</option>
                        </select>
                    </div>
                </div>

                <div class="action-buttons">
                    <button id="generateBtn" class="generate-btn" disabled>
                        <span class="btn-text">画像を生成</span>
                        <span class="btn-loader" style="display: none;">生成中...</span>
                    </button>
                    <button id="cancelBtn" class="cancel-btn" style="display: none;">
                        キャンセル
                    </button>
                </div>
            </div>

            <div id="status" class="status"></div>

            <div id="results" class="results"></div>
        </main>

        <footer>
            <p>Powered by fal-ai/nano-banana-pro</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
